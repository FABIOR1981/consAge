<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel - GestiÃ³n de Consultorios</title>
    <link rel="stylesheet" href="css/comunes.css">
    <!-- <link rel="stylesheet" href="css/informe.css"> Solo en informe.html -->
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>
<body>
    <div class="dashboard-container">
        <nav class="nav-bar">
            <span id="user-email">Cargando usuario...</span>
            <button id="logout-btn" class="btn-secondary">Cerrar SesiÃ³n</button>
        </nav>

        <main class="content">
            <h1 id="welcome-msg">Cargando...</h1>
            <div id="dashboard-btns" style="display: flex; gap: 0.5em; margin-bottom: 1em;">
                <div class="menu-nav">
                    <button class="btn btn-primary" id="btn-agenda">Agenda</button>
                    <button class="btn btn-primary" id="btn-reservas">Reservas Futuras</button>
                    <button class="btn btn-primary" id="btn-informe">Informe</button>
                    <button class="btn btn-primary" id="btn-abmusu" style="display:none;">ABM USU</button>
                </div>
            </div>

            <section id="admin-section" style="display: none;" class="card admin-card">
                <h2>ðŸ“Š Reportes Generales</h2>
                <div class="stats-grid">
                    <div class="stat-item">Agendadas: <span id="count-agendadas">0</span></div>
                    <div class="stat-item">Canceladas: <span id="count-canceladas">0</span></div>
                    <div class="stat-item">Anuladas: <span id="count-anuladas">0</span></div>
                </div>
            </section>

            <section id="agenda-section" class="card" style="display:none;">
                <div id="agenda-container"></div>
            </section>
            <section id="reservas-section" class="card" style="display:none;">
                <div id="reservas-container"></div>
            </section>
            <section id="informe-section" class="card" style="display:none;">
                <div id="informe-container"></div>
            </section>
        </main>
    </div>

    <script type="module" src="js/dashboard.js"></script>
    <script>
    // Mostrar botÃ³n ABM USU solo para admin
    document.addEventListener('DOMContentLoaded', function() {
        const email = localStorage.getItem('user-email');
        fetch('data/usuarios.json')
            .then(r => r.json())
            .then(usuarios => {
                const usuario = usuarios.find(u => u.email === email);
                if (usuario && usuario.rol === 'admin') {
                    document.getElementById('btn-abmusu').style.display = '';
                }
            });
        document.getElementById('btn-abmusu').onclick = function() {
            window.location.href = 'abmusu.html';
        };
    });
    </script>
</body>
</html>